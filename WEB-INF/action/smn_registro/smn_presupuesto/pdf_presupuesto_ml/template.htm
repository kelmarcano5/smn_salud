<!DOCTYPE html>
<html>
<head>
	<title>Presupuesto</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link rel="stylesheet" type="text/css" href="${def:context}/pdf.css">
	<script type="text/javascript" src="${def:context}/action/script"></script>
	<script type="text/javascript" src="${def:context}/action/jquery"></script>
   	<script type="text/javascript" src="${def:context}/action/jqueryi"></script>
	</head>
<body>
	<form id="facturas" style="width:1000px; background: #fff;  box-shadow: 0px 0px 0px #fff;">

		<div class="banner">
			<div align="left" style="padding-left: 40px; margin-bottom: -50px; margin: 0 auto; display: inline-block;"><img src="${def:context}/images/logo_vistacalifornia.png" border="0" alt="" vspace="0" hspace="0" width="250" height="100"></div></img>
            <div class="banner">
				<div class="datos">
					<p style="padding: .3em;">Presupuesto N&deg;: ${fld:pre_numero_control} </p>
					<p style="padding: .3em;">Fecha Emisi&oacute;n: ${fld:pre_fecha_registro@dd-MM-yyyy}</p>
					<p style="padding: .3em;">Fecha Vigencia Hasta: ${fld:vigencia_hasta@dd-MM-yyyy}</p>
				</div>
		    </div>
		</div>
		<div align="left" class="subir" style="margin-left: 20px;">
			
		</div>

		<div class="banner">
			<div class="datos">
				<p>Calle Trieste, Los Ruices Sur - Caracas</p>
				<p>Tel&eacute;fonos 257-00-11 / 256-58-30 / 257-94-86</p>
				<p>RIF J-30652948-9</p>
				<p>Paciente: ${fld:nombre_paciente}</p>
				<p>CI.: ${fld:cedula}</p>
				<p>RIF: ${fld:rif}</p>
				<p>Domicilio: ${fld:direccion}</p>
			</div>
			<div class="datos">
				<p>Contratante: ${fld:nombre_contratante}</p>
				<p>M&eacute;dico: ${fld:medico}</p>
				<p>Intervenciones: ${fld:patologia}</p>
				<p>${fld:pre_observaciones}</p>
			</div>
		</div>
		<!-- <br>
		<br> -->
		<div>
			<table class="table table-fixed" style="width:95%; font-size: 7px; margin-top: 50px">
				<thead >
					<tr>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td align="right"></td>
					</tr>

				</thead>
				<tbody>
					
				</tbody>
			</table>
			<div id="tbody">
				
			</div>
		</div>		
		<br>
		<br>
		<!-- <div align="center">
			<button id="imprimir" onclick="imprimir();">Imprimir</button>
		</div> -->
	</form>
</body>
</html>

<script type="text/javascript" >
  	onload = function() {

  		//document.getElementById('imprimir').style.display='none';
  		$('#facturas').printThis({
  			debug: false,               // show the iframe for debugging
		    importCSS: true,            // import parent page css
		    importStyle: false,         // import style tags
		    printContainer: true,       // print outer container/$.selector
		    loadCSS: "/pdf.css",                // path to additional css file - use an array [] for multiple
		    pageTitle: "Presupuesto",              // add title to print page
		    removeInline: false,        // remove inline styles from print elements
		    removeInlineSelector: "*",  // custom selectors to filter inline styles. removeInline must be true
		    printDelay: 333,            // variable print delay
		    header: null,               // prefix to html
		    footer: null,               // postfix to html
		    base: true,                // preserve the BASE tag or accept a string for the URL
		    formValues: false,           // preserve input/form values
		    canvas: false,              // copy canvas content
		    doctypeString: '',       // enter a different doctype for older markup
		    removeScripts: true,       // remove script tags from print content
		    copyTagClasses: true,      // copy classes from the html & body tag
		    beforePrintEvent: null,     // function for printEvent in iframe
		    beforePrint: null,          // function called before iframe is filled
		    afterPrint: null            // function called before iframe is removed
  		});

  		let myTable="";
  		let cont=0;
  		let subtotal_monto_neto_ml=0;
  		let total_monto_neto_ml=0;
		
		myTable+="<table>";
  		<grupotitulo>
			myTable+="<tr style='font-size: 14px'>";
			myTable+="<td style='font-weight: bold; font-size: 14px;' colspan='2'>${fld:grupo_titulo}</td>";
			myTable+="</tr>";
			<detalle>
	  			if("${fld:titulo_id}"=="${fld:smn_grupo_titulo_impresion_id}")
				{
					subtotal_monto_neto_ml+=parseFloat("${fld:prc_monto_neto_ml}");
						subtotal_monto_neto_ml=subtotal_monto_neto_ml+0
					myTable+="<tr class='detalle_tab'>";
					myTable+="<td style='font-size: 12px; font-family:Arial;' align='left'>${fld:componentes}</td>";
					myTable+="<td style='font-size: 12px; font-family:Arial;'align='right'>${fld:prc_monto_neto_ml@#,###,##0.00}</td>";
					myTable+="</tr>";
				}
	  		</detalle>
	  		myTable+="<tr>";
	  		myTable+="<td align='right' style='font-weight: bold; font-size: 14px; margin-right: 280px;'>SUB SUB-TOTAL</td>";
	  		myTable+="<td align='right' style='font-weight: bold; font-size: 14px; font-family:Arial; margin-bottom:15px'>"+subtotal_monto_neto_ml.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1.").toString()+"</td>";
	  		myTable+="</tr>";
			total_monto_neto_ml+=subtotal_monto_neto_ml;
			
			subtotal_monto_neto_ml=0;
			cont++;
		</grupotitulo>
		myTable+="<tr>";
		myTable+="<td align='right' style='font-weight: bold; font-size: 14px; font-family:Arial;'>TOTAL</td>";
		myTable+="<td align='right' style='font-weight: bold; font-size: 14px; font-family:Arial;'>"+total_monto_neto_ml.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1.").toString()+"</td>";
		myTable+="</tr>";
		myTable+="</table>";
		document.getElementById('tbody').innerHTML = myTable;
  	}

</script>


