INSERT INTO smn_salud.smn_ingreso_movimiento
(
	smn_ingresos_mov_id,
	smn_ingreso_id,
	smn_servicios_rf,
	smn_unidades_servicios_rf,
	smn_componente_rf,
	inm_accion,
	inm_cantidad,
	inm_precio_ml,
	inm_monto_ml,
	inm_precio_ma,
	inm_monto_ma,
	smn_moneda_rf,
	smn_tasa_rf,
	inm_monto_cobertura_contratante,
	inm_monto_cobertura_paciente,
	smn_tipo_consulta_rf,
	smn_grupo_prestador_servicio_rf,
	smn_prestador_servicio_rf,
	smn_motivos_id,
	smn_clase_auxiliar_rf,
	smn_auxiliar_rf,
	inm_ordenante_descripcion,
	smn_sintoma_id,
	inm_tipo_orden,
	inm_num_orden_medica,
	inm_estatus,
	inm_idioma,
	inm_usuario,
	inm_fecha_registro,
	inm_hora,
	smn_item_rf,
	smn_prestacion_servicio_medico_cabecera_id
)
VALUES
(
	${seq:nextval@smn_salud.seq_smn_ingreso_movimiento},
	${fld:ingresoid},
	${fld:smn_servicios_rf},
	${fld:smn_unidades_servicios_rf},
	0,
	'PRESTACION',
	1,
	case
		when ${fld:smn_precio_ml} is null then ${fld:smn_precio_ma}*(select smn_base.smn_tasas_de_cambio.tca_tasa_cambio from smn_base.smn_tasas_de_cambio where smn_base.smn_tasas_de_cambio.tca_fecha_vigencia=CURRENT_DATE and smn_base.smn_tasas_de_cambio.tca_tipo_tasa=(select smn_salud.smn_documento.tca_tipo_tasa from smn_salud.smn_documento where smn_salud.smn_documento.smn_documento_id = (select smn_salud.smn_ingresos.smn_documento_id from smn_salud.smn_ingresos where smn_salud.smn_ingresos.smn_ingresos_id=${fld:ingresoid}))and smn_base.smn_tasas_de_cambio.tca_estatus in ('AC') LIMIT 1) else ${fld:smn_precio_ml}
	end,
	case
		when ${fld:smn_precio_ml} is null then ${fld:smn_precio_ma}*(select smn_base.smn_tasas_de_cambio.tca_tasa_cambio from smn_base.smn_tasas_de_cambio where smn_base.smn_tasas_de_cambio.tca_fecha_vigencia=CURRENT_DATE and smn_base.smn_tasas_de_cambio.tca_tipo_tasa=(select smn_salud.smn_documento.tca_tipo_tasa from smn_salud.smn_documento where smn_salud.smn_documento.smn_documento_id = (select smn_salud.smn_ingresos.smn_documento_id from smn_salud.smn_ingresos where smn_salud.smn_ingresos.smn_ingresos_id=${fld:ingresoid}))and smn_base.smn_tasas_de_cambio.tca_estatus in ('AC') LIMIT 1) else ${fld:smn_precio_ml}
	end,
	${fld:smn_precio_ma},
	${fld:smn_precio_ma},
	(select smn_base.smn_tasas_de_cambio.smn_monedas_id from smn_base.smn_tasas_de_cambio where smn_base.smn_tasas_de_cambio.tca_fecha_vigencia=CURRENT_DATE and smn_base.smn_tasas_de_cambio.tca_tipo_tasa=(select smn_salud.smn_documento.tca_tipo_tasa from smn_salud.smn_documento where smn_salud.smn_documento.smn_documento_id = (select smn_salud.smn_ingresos.smn_documento_id from smn_salud.smn_ingresos where smn_salud.smn_ingresos.smn_ingresos_id=${fld:ingresoid}))),
	(select smn_base.smn_tasas_de_cambio.smn_tasas_de_cambio_id from smn_base.smn_tasas_de_cambio where smn_base.smn_tasas_de_cambio.tca_fecha_vigencia=CURRENT_DATE and smn_base.smn_tasas_de_cambio.tca_tipo_tasa=(select smn_salud.smn_documento.tca_tipo_tasa from smn_salud.smn_documento where smn_salud.smn_documento.smn_documento_id = (select smn_salud.smn_ingresos.smn_documento_id from smn_salud.smn_ingresos where smn_salud.smn_ingresos.smn_ingresos_id=${fld:ingresoid}))and smn_base.smn_tasas_de_cambio.tca_estatus in ('AC') LIMIT 1),
	0,
	0,
	0,
	${fld:smn_grupo_prestador_rf},
	0,
	0,
	0,
	0,
	'PRESTACION',
	0,
	'CO',
	${fld:smn_ordenes_medicas_id},
	'PR',
	'${def:locale}',
	'${def:user}',
	{d '${def:date}'},
	'${def:time}',
	0,
	0
)